# Frequently Asked Questions

## My Application Contains Dynamically-Loaded HIP Modules. Will It Work With Luthier?

Yes. Luthier can capture all loaded code objects on to the device. It can capture all kernels being launched on each
device, except the BLIT kernels used internally by HSA (ROCr) due to HSA tooling limitations. More specifically,
the internal HSA Queue cannot be wrapped in an intercept Queue, hence Luthier does not get notified when a BLIT kernel
gets launched. As soon as the ROCm runtime team allow tools to capture BLIT kernel launches, we will investigate how
to support it on our end.

## Why Build Another Version of LLVM? Doesn't ROCm Ship With LLVM Already?

There are a few reasons behind this:

1. To expose the enum of registers and instructions used internally by the AMDGPU backend to the tool writer.
   These enums gets generated by the Tablegen program during build, but does not get installed or shipped by the ROCm
   LLVM. It is possible to generate this on Luthier's side instead of making the LLVM's CMake build recipe doing it 
   for us, but we haven't had time to investigate this yet.
2. The ROCm LLVM does not ship with runtime type information (RTTI), and Luthier uses features that require RTTI; Some
   examples are making `llvm::Error`s or using the `llvm::formatv` function. These are useful utilities that makes 
   development easier for us, so we don't plan on removing them from our code base.
3. We require a bleeding-edge LLVM installation over the one shipped by ROCm (which we ship in our dev 
   containers). We haven't been able to create a clean version of it that does not break the HIP compiler driver (
   environment and bitcode paths gets messed up) and Luthier (mysterious segfaults). The only reliable way Luthier 
   works is with 2 separate LLVM installation as shown in the dev container's Dockerfiles.
In a nutshell, it is possible to remove this step of building Luthier; But currently, it is not our priority, and 
requires troubleshooting which we don't have time for as of right now.